(function(t){function e(e){for(var n,s,o=e[0],l=e[1],c=e[2],u=0,p=[];u<o.length;u++)s=o[u],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&p.push(a[s][0]),a[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);h&&h(e);while(p.length)p.shift()();return r.push.apply(r,c||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,o=1;o<i.length;o++){var l=i[o];0!==a[l]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=i[0]))}return t}var n={},a={app:0},r=[];function s(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var h=l;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";i("85ec")},"05d9":function(t,e,i){"use strict";i("ac36")},1:function(t,e){},2:function(t,e){},4199:function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-app",[i("app-bar",{attrs:{name:t.name},on:{"new-project":t.newProject,"open-project":t.openProject,"save-project":t.saveProject,"copy-face":t.copyFace,"paste-face":t.pasteFace,"reset-face":t.resetFace}}),i("v-main",[i("timeline",{ref:"timeline",attrs:{layers:t.layers,"focus-capture":!t.saveProjectDialogue},on:{update:t.updateTime,key:t.addKeyframe,rekey:t.updateKeyframe,unkey:t.deleteKeyframe}}),i("editor-canvas",{ref:"editor",attrs:{width:t.width,height:t.height,layers:t.layers,background:t.background},on:{update:t.updateShape}}),i("v-dialog",{attrs:{width:"500"},model:{value:t.saveProjectDialogue,callback:function(e){t.saveProjectDialogue=e},expression:"saveProjectDialogue"}},[i("v-card",[i("v-card-title",[t._v(" Save animation ")]),i("v-card-text",[i("v-form",[i("v-text-field",{attrs:{label:"File name"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),i("v-divider"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",text:""},on:{click:t.downloadProject}},[t._v(" Save ")])],1)],1)],1)],1)],1)},r=[],s=(i("b0c0"),i("c35a"),i("a9e3"),i("ac1f"),i("5319"),i("4de4"),i("159b"),i("cb29"),i("d81d"),i("a434"),i("d3b7"),i("ddb0"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-app-bar",{attrs:{app:"",dense:""}},[i("v-app-bar-title",[i("v-icon",{attrs:{size:"1.8rem"}},[t._v("mdi-baby-face")]),t._v(" Animator "+t._s(t.name.length>0?" - "+t.name:"")+" ")],1),i("v-spacer"),i("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,a=e.attrs;return[i("v-btn",t._g(t._b({attrs:{text:""}},"v-btn",a,!1),n),[t._v(" Animation ")])]}}])},[i("v-list",{attrs:{dense:""}},[i("v-list-item",{on:{click:t.newProject}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-new-box")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(" New ")]),i("input",{staticClass:"hidden",attrs:{type:"file",id:"new-project"},on:{change:t.readSVG}})],1)],1),i("v-list-item",{on:{click:t.openProject}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-folder-open")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(" Open ")]),i("input",{staticClass:"hidden",attrs:{type:"file",id:"open-project"},on:{change:t.readJSON}})],1)],1),i("v-list-item",{on:{click:t.saveProject}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-content-save")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(" Save ")])],1)],1)],1)],1),i("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,a=e.attrs;return[i("v-btn",t._g(t._b({attrs:{text:""}},"v-btn",a,!1),n),[t._v(" Keyframe ")])]}}])},[i("v-list",{attrs:{dense:""}},[i("v-list-item",{on:{click:function(e){return t.$emit("copy-face")}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-content-save")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(" Copy ")])],1)],1),i("v-list-item",{on:{click:function(e){return t.$emit("paste-face")}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-content-save")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(" Paste ")])],1)],1),i("v-list-item",{on:{click:function(e){return t.$emit("reset-face")}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-content-save")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(" Reset ")])],1)],1)],1)],1)],1)}),o=[],l={name:"AppBar",props:{name:{type:String,default:""}},methods:{newProject:function(){document.querySelector("input#new-project").click()},openProject:function(){document.querySelector("input#open-project").click()},saveProject:function(){this.$emit("save-project")},readSVG:function(t){if(!(t.target.files.length<1)){var e=new FileReader;e.onload=function(t){this.$emit("new-project",t.target.result)}.bind(this),e.readAsText(t.target.files[0])}},readJSON:function(t){if(!(t.target.files.length<1)){var e=new FileReader;e.onload=function(t){this.$emit("open-project",JSON.parse(t.target.result))}.bind(this),e.readAsText(t.target.files[0])}}}},c=l,h=i("2877"),u=i("6544"),p=i.n(u),d=i("40dc"),f=i("bb78"),m=i("8336"),v=i("132d"),y=i("8860"),g=i("da13"),b=i("5d23"),w=i("34c3"),S=i("e449"),k=i("2fa4"),j=Object(h["a"])(c,s,o,!1,null,"176d7e0a",null),_=j.exports;p()(j,{VAppBar:d["a"],VAppBarTitle:f["a"],VBtn:m["a"],VIcon:v["a"],VList:y["a"],VListItem:g["a"],VListItemContent:b["a"],VListItemIcon:w["a"],VListItemTitle:b["b"],VMenu:S["a"],VSpacer:k["a"]});var x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"timeliner-container"})},D=[],P=i("fa3c"),$={name:"Timeline",props:{layers:{type:Array,required:!0},focusCapture:{type:Boolean,default:!1}},data:function(){return{timeliner:null,data:{}}},watch:{focusCapture:function(){this.timeliner&&this.timeliner.setFocusCapture(this.focusCapture)}},methods:{reset:function(){this.timeliner&&this.timeliner.dispose(),this.timeliner=null,this.data=null},key:function(t){this.timeliner.fire("keyframe",t)},getData:function(){return this.timeliner.getData()},setData:function(t){var e=this;this.data={},t.layers.forEach((function(t){e.data[t.name]=0})),this.initTimeliner(),this.timeliner.load(t),console.log(this.timeliner)},initTimeliner:function(){var t=this;this.timeliner&&(this.timeliner.dispose(),this.timeliner=null),this.timeliner=new P["a"](this.data),document.querySelector("timeliner").id="timeliner",this.layers.forEach((function(e){t.timeliner.addLayer(e.name)})),this.timeliner.on("update",(function(e){e.length>0&&t.$emit("update",e)})),this.timeliner.on("keyframe.add",(function(e,i,n){t.$emit("key",e,i,n)})),this.timeliner.on("keyframe.update",(function(e,i){t.$emit("rekey",e,i)})),this.timeliner.on("keyframe.delete",(function(e,i){t.$emit("unkey",e,i)}))}}},V=$,O=(i("f2b0"),Object(h["a"])(V,x,D,!1,null,null,null)),R=O.exports,E=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("canvas",{style:{background:t.background},attrs:{id:"editor-canvas",hidpi:"on"}})},T=[],C=i("2222"),A={name:"EditorCanvas",props:{layers:{type:Array,required:!0},width:{type:Number,required:!0},height:{type:Number,required:!0},background:{type:String,default:"gray"}},data:function(){return{shapes:[],tool:null,isEditing:!1,hitResult:null,hitOptions:{segments:!0,stroke:!0,fill:!0,handles:!0,tolerance:5},interShape:null,fromShape:null,toShape:null}},computed:{editing:{get:function(){return this.isEditing},set:function(t){if(this.isEditing&&!t){var e=this.shapes.indexOf(this.hitResult.item),i=this.hitResult.item.exportSVG();this.$emit("update",e,i.attributes["d"].value)}this.isEditing=t}}},watch:{width:function(){C["paper"].view.viewSize=new C["paper"].Size(this.width,this.height)},height:function(){C["paper"].view.viewSize=new C["paper"].Size(this.width,this.height)},layers:function(){var t=this;this.shapes=[],this.layers.forEach((function(e,i){var n=new C["paper"].Path(e.shape);n.strokeColor=e.attributes["stroke"],n.strokeWidth=e.attributes["stroke-width"],t.shapes[i]=n}))}},mounted:function(){var t=document.getElementById("editor-canvas");C["paper"].setup(t),this.tool=new C["paper"].Tool,this.tool.onMouseDown=this.onMouseDown.bind(this),this.tool.onMouseUp=this.onMouseUp.bind(this),this.tool.onMouseDrag=this.onMouseDrag.bind(this),this.interShape=new C["paper"].Path({insert:!1}),this.fromShape=new C["paper"].Path({insert:!1}),this.toShape=new C["paper"].Path({insert:!1})},methods:{reset:function(){this.shapes.forEach((function(t){t.remove()})),this.shapes=[],this.isEditing=!1,this.hitResult=null},getLayerShape:function(t){return this.shapes[t]},interpolate:function(t,e,i,n){var a=this.layers[t].keys;return e<0&&(e=0),e>a.length-1&&(e=a.length-1),i<0&&(i=0),i>a.length-1&&(i=a.length-1),0===a.length?(this.interShape.pathData=this.layers[t].shape,this.interShape):e===i?(this.interShape.pathData=a[e],this.interShape):(this.fromShape.pathData=a[e],this.toShape.pathData=a[i],this.interShape.interpolate(this.fromShape,this.toShape,n),this.interShape)},pathify:function(t){return t.exportSVG().attributes["d"].value},draw:function(){var t=this;this.layers.forEach((function(e,i){if(e.time){var n=t.interpolate(i,e.time.start,e.time.end,e.time.percentage);t.shapes[i].pathData=n.pathData}})),C["paper"].view.draw()},onMouseDown:function(t){this.hitResult=C["paper"].project.hitTest(t.point,this.hitOptions),this.shapes.forEach((function(t){t.fullySelected=!1})),this.hitResult&&(this.hitResult.item.fullySelected=!0)},onMouseUp:function(){this.editing=!1,this.hitResult&&(this.hitResult=null)},onMouseDrag:function(t){if(this.hitResult){if(this.editing=!0,"fill"===this.hitResult.type||"stroke"===this.hitResult.type){var e=this.hitResult.item;e.position.x+=t.delta.x,e.position.y+=t.delta.y}if("segment"===this.hitResult.type){var i=this.hitResult.segment;i.point.x+=t.delta.x,i.point.y+=t.delta.y}else if("handle-in"===this.hitResult.type){var n=this.hitResult.segment.handleIn;if(n.x+=t.delta.x,n.y+=t.delta.y,!C["paper"].Key.isDown("shift")){var a=this.hitResult.segment.handleOut;a.angle=n.angle+180}}else if("handle-out"===this.hitResult.type){var r=this.hitResult.segment.handleOut;if(r.x+=t.delta.x,r.y+=t.delta.y,!C["paper"].Key.isDown("shift")){var s=this.hitResult.segment.handleIn;s.angle=r.angle+180}}}else this.shapes.forEach((function(t){t.fullySelected=!1}))}}},M=A,F=(i("05d9"),Object(h["a"])(M,E,T,!1,null,"10ee80bc",null)),I=F.exports,L=i("78a2"),K=i("645d"),N=i.n(K),B={name:"App",components:{AppBar:_,Timeline:R,EditorCanvas:I},data:function(){return{width:640,height:480,name:"Untitled",layers:[],background:"gray",saveProjectDialogue:!1,clipboard:null}},mounted:function(){},methods:{reset:function(){this.width=640,this.height=480,this.name="Untitled",this.background="gray",this.layers=[],this.saveProjectDialogue=!1,this.$refs.timeline.reset(),this.$refs.editor.reset()},newProject:function(t){var e=this;this.reset(),Object(L["parse"])(t).then((function(t){t.attributes.width&&(e.width=Number.parseFloat(t.attributes.width.replace("px",""))),t.attributes.height&&(e.height=Number.parseFloat(t.attributes.height.replace("px","")));var i=t.children.filter((function(t){return"title"===t.name}));if(i.length>0&&i[0].children.length>0){var n=i[0].children.filter((function(t){return"text"===t.type}));n.length>0&&(e.name=n[0].value)}var a=t.children.filter((function(t){return"g"===t.name}));if(a.length>0&&a[0].children.length>0){var r=1;a[0].children.forEach((function(t){if("rect"!==t.name||t.attributes.id){var i="Shape ".concat(r);r++,e.layers.push({name:i,keys:[],time:null,attributes:t.attributes,shape:N()(t)})}else t.attributes.fill&&(e.background=t.attributes.fill)}))}e.$refs.timeline.initTimeliner()}))},openProject:function(t){this.reset(),this.layers=t.layers,this.name=t.name,this.width=t.width,this.height=t.height,this.background=t.background,this.$refs.timeline.setData(t.timeliner)},saveProject:function(){this.saveProjectDialogue=!0},downloadProject:function(){var t={width:this.width,height:this.height,name:this.name,layers:this.layers,background:this.background,timeliner:this.$refs.timeline.getData()},e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("download",this.name+".json"),document.body.appendChild(i),i.click(),i.remove(),this.saveProjectDialogue=!1},copyFace:function(){var t=this;this.clipboard=this.layers.map((function(e,i){return t.$refs.editor.getLayerShape(i).pathData}))},pasteFace:function(){var t=this;this.clipboard&&this.layers.forEach((function(e,i){t.$refs.editor.shapes[i].pathData=t.clipboard[i],t.$refs.timeline.key(i)}))},resetFace:function(){var t=this;this.layers.forEach((function(e,i){t.$refs.editor.shapes[i].pathData=e.shape,t.$refs.timeline.key(i)}))},updateTime:function(t){var e=this;t.forEach((function(t,i){e.layers[i].time=t})),this.$refs.editor.draw()},updateShape:function(t){this.$refs.timeline.key(t)},addKeyframe:function(t,e){var i=this.$refs.editor.getLayerShape(t);this.layers[t].keys.splice(e,0,i.pathData)},updateKeyframe:function(t,e){var i=this.$refs.editor.getLayerShape(t);this.layers[t].keys[e]=i.pathData},deleteKeyframe:function(t,e){this.layers[t].keys.splice(e,1)}}},q=B,J=(i("034f"),i("7496")),U=i("b0af"),z=i("99d9"),G=i("169a"),W=i("ce7e"),H=i("4bd4"),Q=i("f6c4"),X=i("8654"),Y=Object(h["a"])(q,a,r,!1,null,null,null),Z=Y.exports;p()(Y,{VApp:J["a"],VBtn:m["a"],VCard:U["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VDialog:G["a"],VDivider:W["a"],VForm:H["a"],VMain:Q["a"],VSpacer:k["a"],VTextField:X["a"]});var tt=i("f309");n["a"].use(tt["a"]);var et=new tt["a"]({});n["a"].config.productionTip=!1,new n["a"]({vuetify:et,render:function(t){return t(Z)}}).$mount("#app")},"85ec":function(t,e,i){},ac36:function(t,e,i){},f2b0:function(t,e,i){"use strict";i("4199")}});
//# sourceMappingURL=app.13e79fe0.js.map